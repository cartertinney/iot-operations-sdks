{
    "name": "Nightly MQTT Broker",
    "build": {
        "dockerfile": "../Dockerfile"
    },
    "hostRequirements": {
        "cpus": 2,
        "memory": "16gb",
        "storage": "48gb"
    },
    "features": {
        "ghcr.io/devcontainers/features/dotnet:2": {},
        "ghcr.io/devcontainers/features/rust:1": {},
        "ghcr.io/devcontainers/features/go:1": {},
        "ghcr.io/devcontainers/features/azure-cli:1": {
            "extensions": "connectedk8s,k8s-extension,azure-iot-ops"
        }
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "vsciot-vscode.vscode-dtdl",
                "ms-azuretools.vscode-bicep",
                "ms-azuretools.vscode-docker",
                "ms-kubernetes-tools.vscode-kubernetes-tools"
            ]
        },
        "settings": {
            "scm.repositories.visible": true,
            "scm.alwaysShowRepositories": true,
            "scm.defaultViewMode": "tree",
            "files.trimTrailingWhitespace": true,
            "files.trimFinalNewlines": true,
            "telemetry.telemetryLevel": "off",
            "redhat.telemetry.enabled": false
        }
    },
    "containerEnv": {
        "DOTNET_CLI_TELEMETRY_OPTOUT": "true"
    },
    "forwardPorts": [
        1883,
        8883,
        8884
    ],

    "onCreateCommand": ".devcontainer/onCreateCommand.sh",
    "postCreateCommand": ".devcontainer/postCreateCommand.sh; tools/deployment/deploy-aio.sh nightly",
    "postStartCommand": ".devcontainer/postStartCommand.sh"
}